<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>General | Full-stack web development notes.</title>
    <meta name="description" content="Full-stack web development notes.">
    
    
    <link rel="preload" href="/notes/assets/css/0.styles.69480afa.css" as="style"><link rel="preload" href="/notes/assets/js/app.b2f0b337.js" as="script"><link rel="preload" href="/notes/assets/js/2.1225d179.js" as="script"><link rel="preload" href="/notes/assets/js/29.c8a41031.js" as="script"><link rel="prefetch" href="/notes/assets/js/10.ad79507a.js"><link rel="prefetch" href="/notes/assets/js/11.c1cf1b66.js"><link rel="prefetch" href="/notes/assets/js/12.13036d52.js"><link rel="prefetch" href="/notes/assets/js/13.7938725b.js"><link rel="prefetch" href="/notes/assets/js/14.1de88fe6.js"><link rel="prefetch" href="/notes/assets/js/15.8efffe63.js"><link rel="prefetch" href="/notes/assets/js/16.6e436b02.js"><link rel="prefetch" href="/notes/assets/js/17.19a8b946.js"><link rel="prefetch" href="/notes/assets/js/18.ee0c949d.js"><link rel="prefetch" href="/notes/assets/js/19.4b320e7c.js"><link rel="prefetch" href="/notes/assets/js/20.08ab0b67.js"><link rel="prefetch" href="/notes/assets/js/21.b99757f6.js"><link rel="prefetch" href="/notes/assets/js/22.00f309fb.js"><link rel="prefetch" href="/notes/assets/js/23.ce26102d.js"><link rel="prefetch" href="/notes/assets/js/24.b0410150.js"><link rel="prefetch" href="/notes/assets/js/25.8d753f87.js"><link rel="prefetch" href="/notes/assets/js/26.18e891e6.js"><link rel="prefetch" href="/notes/assets/js/27.7d7999d4.js"><link rel="prefetch" href="/notes/assets/js/28.9774fd5a.js"><link rel="prefetch" href="/notes/assets/js/3.50d7592f.js"><link rel="prefetch" href="/notes/assets/js/30.97f18ff4.js"><link rel="prefetch" href="/notes/assets/js/31.1a22d7ad.js"><link rel="prefetch" href="/notes/assets/js/32.3111817b.js"><link rel="prefetch" href="/notes/assets/js/33.6efec194.js"><link rel="prefetch" href="/notes/assets/js/34.dda5567c.js"><link rel="prefetch" href="/notes/assets/js/35.40a56c44.js"><link rel="prefetch" href="/notes/assets/js/36.458d1789.js"><link rel="prefetch" href="/notes/assets/js/37.9e76c86f.js"><link rel="prefetch" href="/notes/assets/js/38.ea35f119.js"><link rel="prefetch" href="/notes/assets/js/39.474b3651.js"><link rel="prefetch" href="/notes/assets/js/4.5850f364.js"><link rel="prefetch" href="/notes/assets/js/40.9b2812bd.js"><link rel="prefetch" href="/notes/assets/js/41.b2ed6f89.js"><link rel="prefetch" href="/notes/assets/js/42.bedea5a6.js"><link rel="prefetch" href="/notes/assets/js/43.52d01c0b.js"><link rel="prefetch" href="/notes/assets/js/44.bf6db40e.js"><link rel="prefetch" href="/notes/assets/js/45.a6ddf2fb.js"><link rel="prefetch" href="/notes/assets/js/46.ccf7223f.js"><link rel="prefetch" href="/notes/assets/js/47.6b608624.js"><link rel="prefetch" href="/notes/assets/js/48.02d66f09.js"><link rel="prefetch" href="/notes/assets/js/49.35cdabf7.js"><link rel="prefetch" href="/notes/assets/js/5.4fdd094a.js"><link rel="prefetch" href="/notes/assets/js/50.8e046486.js"><link rel="prefetch" href="/notes/assets/js/51.c23cdab9.js"><link rel="prefetch" href="/notes/assets/js/52.a0c473fb.js"><link rel="prefetch" href="/notes/assets/js/53.9d5c6032.js"><link rel="prefetch" href="/notes/assets/js/54.279ef24c.js"><link rel="prefetch" href="/notes/assets/js/55.f263bef6.js"><link rel="prefetch" href="/notes/assets/js/56.e689e4b6.js"><link rel="prefetch" href="/notes/assets/js/6.04dbe20d.js"><link rel="prefetch" href="/notes/assets/js/7.64d3e5cf.js"><link rel="prefetch" href="/notes/assets/js/8.a6fbdd51.js"><link rel="prefetch" href="/notes/assets/js/9.0b25e1bc.js">
    <link rel="stylesheet" href="/notes/assets/css/0.styles.69480afa.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notes/" class="home-link router-link-active"><!----> <span class="site-name">Full-stack web development notes.</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/8483/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/8483/notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/notes/" class="sidebar-link">Introduction</a></li><li><a href="/notes/topics/algos.html" class="sidebar-link">Algos</a></li><li><a href="/notes/topics/bash.html" class="sidebar-link">Bash</a></li><li><a href="/notes/topics/dom.html" class="sidebar-link">Dom</a></li><li><a href="/notes/topics/express.html" class="sidebar-link">Express</a></li><li><a href="/notes/topics/mssql.html" class="sidebar-link">Mssql</a></li><li><a href="/notes/topics/raspberrypi.html" class="sidebar-link">Raspberrypi</a></li><li><a href="/notes/topics/testing.html" class="sidebar-link">Testing</a></li><li><a href="/notes/topics/webpack.html" class="sidebar-link">Webpack</a></li><li><a href="/notes/topics/ansible.html" class="sidebar-link">Ansible</a></li><li><a href="/notes/topics/caching.html" class="sidebar-link">Caching</a></li><li><a href="/notes/topics/electricity.html" class="sidebar-link">Electricity</a></li><li><a href="/notes/topics/filesystem.html" class="sidebar-link">Filesystem</a></li><li><a href="/notes/topics/mysql.html" class="sidebar-link">Mysql</a></li><li><a href="/notes/topics/react.html" class="sidebar-link">React</a></li><li><a href="/notes/topics/tmux.html" class="sidebar-link">Tmux</a></li><li><a href="/notes/topics/architecture.html" class="sidebar-link">Architecture</a></li><li><a href="/notes/topics/compression.html" class="sidebar-link">Compression</a></li><li><a href="/notes/topics/electronics.html" class="sidebar-link">Electronics</a></li><li><a href="/notes/topics/fp.html" class="sidebar-link">Fp</a></li><li><a href="/notes/topics/networking.html" class="sidebar-link">Networking</a></li><li><a href="/notes/topics/restful.html" class="sidebar-link">Restful</a></li><li><a href="/notes/topics/users.html" class="sidebar-link">Users</a></li><li><a href="/notes/topics/arduino.html" class="sidebar-link">Arduino</a></li><li><a href="/notes/topics/config.html" class="sidebar-link">Config</a></li><li><a href="/notes/topics/electron.html" class="active sidebar-link">Electron</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notes/topics/electron.html#ipcmain" class="sidebar-link">ipcMain</a></li><li class="sidebar-sub-header"><a href="/notes/topics/electron.html#ipcrenderer" class="sidebar-link">ipcRenderer</a></li><li class="sidebar-sub-header"><a href="/notes/topics/electron.html#remote" class="sidebar-link">Remote</a></li><li class="sidebar-sub-header"><a href="/notes/topics/electron.html#developer-tools" class="sidebar-link">Developer Tools</a></li><li class="sidebar-sub-header"><a href="/notes/topics/electron.html#menu" class="sidebar-link">Menu</a></li><li class="sidebar-sub-header"><a href="/notes/topics/electron.html#new-window" class="sidebar-link">New Window</a></li><li class="sidebar-sub-header"><a href="/notes/topics/electron.html#shortcuts-accelerators" class="sidebar-link">Shortcuts (Accelerators)</a></li><li class="sidebar-sub-header"><a href="/notes/topics/electron.html#electron-packager" class="sidebar-link">Electron Packager</a></li><li class="sidebar-sub-header"><a href="/notes/topics/electron.html#electron-builder" class="sidebar-link">Electron Builder</a></li><li class="sidebar-sub-header"><a href="/notes/topics/electron.html#electron-updater" class="sidebar-link">Electron Updater</a></li></ul></li><li><a href="/notes/topics/git.html" class="sidebar-link">Git</a></li><li><a href="/notes/topics/nginx.html" class="sidebar-link">Nginx</a></li><li><a href="/notes/topics/rfid.html" class="sidebar-link">Rfid</a></li><li><a href="/notes/topics/vagrant.html" class="sidebar-link">Vagrant</a></li><li><a href="/notes/topics/async.html" class="sidebar-link">Async</a></li><li><a href="/notes/topics/csharp.html" class="sidebar-link">Csharp</a></li><li><a href="/notes/topics/elm.html" class="sidebar-link">Elm</a></li><li><a href="/notes/topics/javascript.html" class="sidebar-link">Javascript</a></li><li><a href="/notes/topics/nodemcu.html" class="sidebar-link">Nodemcu</a></li><li><a href="/notes/topics/security.html" class="sidebar-link">Security</a></li><li><a href="/notes/topics/vim.html" class="sidebar-link">Vim</a></li><li><a href="/notes/topics/babel.html" class="sidebar-link">Babel</a></li><li><a href="/notes/topics/css.html" class="sidebar-link">Css</a></li><li><a href="/notes/topics/es6.html" class="sidebar-link">Es6</a></li><li><a href="/notes/topics/linux.html" class="sidebar-link">Linux</a></li><li><a href="/notes/topics/node.html" class="sidebar-link">Node</a></li><li><a href="/notes/topics/ssh.html" class="sidebar-link">Ssh</a></li><li><a href="/notes/topics/vm.html" class="sidebar-link">Vm</a></li><li><a href="/notes/topics/base.html" class="sidebar-link">Base</a></li><li><a href="/notes/topics/docker.html" class="sidebar-link">Docker</a></li><li><a href="/notes/topics/excel.html" class="sidebar-link">Excel</a></li><li><a href="/notes/topics/mobile.html" class="sidebar-link">Mobile</a></li><li><a href="/notes/topics/oop.html" class="sidebar-link">Oop</a></li><li><a href="/notes/topics/systemd.html" class="sidebar-link">Systemd</a></li><li><a href="/notes/topics/vscode.html" class="sidebar-link">Vscode</a></li></ul> </aside> <main class="page"> <div class="content default"><h1 id="general"><a href="#general" aria-hidden="true" class="header-anchor">#</a> General</h1> <p>Electron is a framework which allows to create desktop apps with HTML, CSS and Javascript. It's basically a Chrome browser with less features. It can also access the file system, whilst web apps cannot.</p> <p>The HTML, CSS and Javascript can compile to executables for Windows, Mac or Linux.</p> <p>Some notable apps that are built with it are Atom, VS Code and Slack.</p> <p><strong>Try and keep in mind that Electron is simply a &quot;manager&quot; for a browser instance. It's the glue between the OS and the BrowserWindow.</strong></p> <p><strong>As soon as you're working in a renderer process, you're writing standard javascript and Electron really doesn't matter any longer.</strong></p> <h1 id="install"><a href="#install" aria-hidden="true" class="header-anchor">#</a> Install</h1> <p>Don't install Electron as a global because then other people have to set stuff up to run your app (i.e. they now have to micromanage which version of Electron they have installed globally).</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> electron --save-dev
</code></pre></div><p><strong>All tools should be installed as dev dependencies.</strong></p> <h3 id="errors"><a href="#errors" aria-hidden="true" class="header-anchor">#</a> Errors</h3> <p>When running <code>npm install electron</code>, some users occasionally encounter installation errors.</p> <p>In almost all cases, these errors are the result of network problems and not actual issues with the electron npm package. Errors like <code>ELIFECYCLE</code>, <code>EAI_AGAIN</code>, <code>ECONNRESET</code>, and <code>ETIMEDOUT</code> are all indications of such network problems.</p> <p><strong>The best resolution is to try reconnecting, switching networks, or just waiting for a bit before trying to install again.</strong></p> <h1 id="run"><a href="#run" aria-hidden="true" class="header-anchor">#</a> Run</h1> <p><strong>Before anything, make sure that <code>package.json</code> is updated with the relevant entry file. Default is <code>index.js</code>.</strong></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;main.js&quot;</span>
</code></pre></div><p><strong>The electron library is not used in the final app build.</strong></p> <p>If electron was installed locally in <code>node_modules</code>.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>./node_modules/.bin/electron <span class="token keyword">.</span>
<span class="token function">npm</span> start <span class="token comment"># We use the above command inside package.json.</span>
</code></pre></div><p>If electron was installed globally.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>electron main.js
electron <span class="token keyword">.</span> <span class="token comment"># Same as above. Looks for main.js inside current directory.</span>
<span class="token function">npm</span> start <span class="token comment"># We use the above command inside package.json.</span>
</code></pre></div><p>Using the wrong one will result in an <code>ELIFECYCLE</code> error.</p> <h3 id="enospc-error"><a href="#enospc-error" aria-hidden="true" class="header-anchor">#</a> ENOSPC error</h3> <p>Listen uses inotify by default on Linux to monitor directories for changes. It's not uncommon to encounter a system limit on the number of files you can monitor. For example, Ubuntu Lucid's (64bit) inotify limit is set to 8192.</p> <p>When this limit is not enough to monitor all files inside a directory, the limit must be increased for Listen to work properly. Set a permanent limit with:</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token keyword">echo</span> fs.inotify.max_user_watches<span class="token operator">=</span>524288 <span class="token operator">|</span> <span class="token function">sudo</span> <span class="token function">tee</span> -a /etc/sysctl.conf <span class="token operator">&amp;&amp;</span> <span class="token function">sudo</span> sysctl -p
</code></pre></div><h1 id="simple-app"><a href="#simple-app" aria-hidden="true" class="header-anchor">#</a> Simple app</h1> <p><strong>main.js</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> electron <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;electron&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> BrowserWindow <span class="token punctuation">}</span> <span class="token operator">=</span> electron<span class="token punctuation">;</span>

<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">800</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">600</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`file://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mainWindow<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;closed&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mainWindow <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;ready&quot;</span><span class="token punctuation">,</span> createWindow<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>We keep the <code>mainWindow</code> variable in the global scope in order to prevent it from being garbage collected, thus losing the window.</p> <p><strong>index.html</strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Window<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Some content<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// We can put our logic here, or offload it with require(&quot;./renderer.js&quot;)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h1 id="main-vs-renderer-process"><a href="#main-vs-renderer-process" aria-hidden="true" class="header-anchor">#</a> Main vs Renderer Process</h1> <p>Electron operates in two runtime contexts i.e. processes.</p> <ul><li><strong>Main</strong> (one) / Node.js / Server / main.js
<ul><li>File system access.</li> <li>Compiled module support.</li> <li>CommonJS modules.</li></ul></li></ul> <ul><li><strong>Renderer</strong> (many) / Chromium browser / Client side
<ul><li>HTML and CSS renderer.</li> <li>DOM access.</li> <li>Web API.</li></ul></li></ul> <p>The main process can create many renderer processes (browser windows), but there is only one main process handling this.</p> <h1 id="ipc-inter-process-communication"><a href="#ipc-inter-process-communication" aria-hidden="true" class="header-anchor">#</a> IPC (Inter Process Communication)</h1> <p>It allows us to send messages (with a payload) between the Main and Renderer processes. To use this, we need:</p> <ul><li>The <code>ipcMain</code> module in the <code>Main</code> process.</li> <li>The <code>ipcRenderer</code> module in the <code>Renderer</code> processes.</li></ul> <p>By default, these modules send messages asynchronously, which is recommended.</p> <h2 id="ipcmain"><a href="#ipcmain" aria-hidden="true" class="header-anchor">#</a> ipcMain</h2> <p><code>ipcMain</code> can only listen for <code>Renderer</code> messages and reply to them by using <code>webContents.send()</code>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Main</span>
<span class="token keyword">var</span> ipcMain <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;electron&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ipcMain<span class="token punctuation">;</span>

win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ipcMain<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;asynchronous-message&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints &quot;ping&quot;</span>
    event<span class="token punctuation">.</span>sender<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;asynchronous-reply&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pong&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

win<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;channel&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;foo!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="ipcrenderer"><a href="#ipcrenderer" aria-hidden="true" class="header-anchor">#</a> ipcRenderer</h2> <p><code>ipcRenderer</code> can send messages to the <code>Main</code> process. It also listens to messages sent from it.</p> <p>You can have 2 windows communicate via the HTML5 messaging API. Again, <strong>when ipc is not required for sending something to The main process which is OS related, there's no need.</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Renderer</span>
<span class="token keyword">var</span> ipcRenderer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;electron&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ipcRenderer<span class="token punctuation">;</span>

ipcRenderer<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token string">&quot;asynchronous-message&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ping&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ipcRenderer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;asynchronous-reply&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// prints &quot;pong&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

ipcRenderer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;channel&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span> args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Prints 'foo!'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="remote"><a href="#remote" aria-hidden="true" class="header-anchor">#</a> Remote</h2> <p>Basically the <code>remote</code> module makes it easy to do stuff normally restricted to the main process in a render process without lots of manual ipc messages back and forth.</p> <p>In Electron, GUI-related modules (such as dialog, menu etc.) are only available in the main process, not in the renderer process. In order to use them from the renderer process, the ipc module is necessary to send inter-process messages to the main process.</p> <p><strong>With the remote module, you can invoke methods of the main process object without explicitly sending inter-process messages</strong>, similar to Java's RMI. An example of creating a browser window from a renderer process:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> remote <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;electron&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>remote<span class="token punctuation">;</span>
<span class="token keyword">const</span> BrowserWindow <span class="token operator">=</span> remote<span class="token punctuation">.</span>BrowserWindow<span class="token punctuation">;</span>

<span class="token keyword">var</span> win <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
win<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token string">&quot;https://github.com&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="examples"><a href="#examples" aria-hidden="true" class="header-anchor">#</a> Examples</h1> <h2 id="developer-tools"><a href="#developer-tools" aria-hidden="true" class="header-anchor">#</a> Developer Tools</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// Add this line in the createWindow main process.</span>
mainWindow<span class="token punctuation">.</span>webContents<span class="token punctuation">.</span><span class="token function">openDevTools</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="menu"><a href="#menu" aria-hidden="true" class="header-anchor">#</a> Menu</h2> <p>If there's no custm menu specified, Electron shows a default one. Using a custom one overrides it.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> electron <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;electron&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// We need to pull menu.</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">,</span> Menu <span class="token punctuation">}</span> <span class="token operator">=</span> electron<span class="token punctuation">;</span>

<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">800</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">600</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`file://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Build menu</span>
    <span class="token keyword">const</span> mainMenu <span class="token operator">=</span> Menu<span class="token punctuation">.</span><span class="token function">buildFromTemplate</span><span class="token punctuation">(</span>mainMenuTemplate<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Set Menu</span>
    Menu<span class="token punctuation">.</span><span class="token function">setApplicationMenu</span><span class="token punctuation">(</span>mainMenu<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;ready&quot;</span><span class="token punctuation">,</span> createWindow<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Array of menu objects</span>
<span class="token keyword">const</span> mainMenuTemplate <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span> <span class="token string">&quot;Menu item&quot;</span><span class="token punctuation">,</span>
        submenu<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> label<span class="token punctuation">:</span> <span class="token string">&quot;Submenu item 1&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> label<span class="token punctuation">:</span> <span class="token string">&quot;Submenu item 2&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="new-window"><a href="#new-window" aria-hidden="true" class="header-anchor">#</a> New Window</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> electron <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;electron&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// We need to pull menu.</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> app<span class="token punctuation">,</span> BrowserWindow<span class="token punctuation">,</span> Menu <span class="token punctuation">}</span> <span class="token operator">=</span> electron<span class="token punctuation">;</span>

<span class="token keyword">let</span> mainWindow<span class="token punctuation">;</span>

<span class="token comment">// Main window.</span>
<span class="token keyword">function</span> <span class="token function">createWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    mainWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> width<span class="token punctuation">:</span> <span class="token number">800</span><span class="token punctuation">,</span> height<span class="token punctuation">:</span> <span class="token number">600</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    mainWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`file://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/index.html`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Build menu</span>
    <span class="token keyword">const</span> mainMenu <span class="token operator">=</span> Menu<span class="token punctuation">.</span><span class="token function">buildFromTemplate</span><span class="token punctuation">(</span>mainMenuTemplate<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Set Menu</span>
    Menu<span class="token punctuation">.</span><span class="token function">setApplicationMenu</span><span class="token punctuation">(</span>mainMenu<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// Create new window.</span>
<span class="token keyword">function</span> <span class="token function">createNewWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    newWindow <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BrowserWindow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        width<span class="token punctuation">:</span> <span class="token number">600</span><span class="token punctuation">,</span>
        height<span class="token punctuation">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
        title<span class="token punctuation">:</span> <span class="token string">&quot;New Window&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    newWindow<span class="token punctuation">.</span><span class="token function">loadURL</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string">`file://</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>__dirname<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/newWindow.html`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;ready&quot;</span><span class="token punctuation">,</span> createWindow<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Array of menu objects</span>
<span class="token keyword">const</span> mainMenuTemplate <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        label<span class="token punctuation">:</span> <span class="token string">&quot;New window&quot;</span><span class="token punctuation">,</span>
        <span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Make the menu item clickable.</span>
            <span class="token function">createNewWindow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Call this in the main process.</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="shortcuts-accelerators"><a href="#shortcuts-accelerators" aria-hidden="true" class="header-anchor">#</a> Shortcuts (Accelerators)</h2> <h1 id="electron-reload"><a href="#electron-reload" aria-hidden="true" class="header-anchor">#</a> Electron Reload</h1> <p>An npm library used for tracking changes in <code>.html</code> and <code>.js</code> rederer files, to avoid closing/starting electron to refresh.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> electron-reload --save-dev
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// main.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;electron-reload&quot;</span><span class="token punctuation">)</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="packaging"><a href="#packaging" aria-hidden="true" class="header-anchor">#</a> Packaging</h1> <p>The app's general information is contained in <code>package.json</code>. We should always package the app from a copy, instead of the working file.</p> <p>The dev-dependencies should also be removed before packaging, along with the code requiring them.</p> <h2 id="electron-packager"><a href="#electron-packager" aria-hidden="true" class="header-anchor">#</a> Electron Packager</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">npm</span> <span class="token function">install</span> -g electron-packager
</code></pre></div><p>There are two ways of packaging the app.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Electron as a dev-dependency, to avoid packaging the module as well.</span>
electron-packager <span class="token keyword">.</span>

<span class="token comment"># Electron version as a flag. The version will be downloaded.</span>
electron-packager <span class="token keyword">.</span> --electron-version<span class="token operator">=</span><span class="token string">&quot;1.8.2&quot;</span>
</code></pre></div><h3 id="platform"><a href="#platform" aria-hidden="true" class="header-anchor">#</a> Platform</h3> <p>If we don't specify a platform, the app will be packaged in the host OS.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Linux</span>
electron-packager <span class="token keyword">.</span> --platform<span class="token operator">=</span>linux --arch<span class="token operator">=</span>x64

<span class="token comment"># Windows</span>
electron-packager <span class="token keyword">.</span> --platform<span class="token operator">=</span>win32 --arch<span class="token operator">=</span>ia32
</code></pre></div><h3 id="asar"><a href="#asar" aria-hidden="true" class="header-anchor">#</a> asar</h3> <p>We can see the source files via <code>Contents/Resources/app</code>. We can hide these by packaging them in an <code>.asar</code> archive. This is similar to a <code>.tar</code> file, but without compression. This archive can be easily unpacked, but it does provide an extra layer of security.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Use asar to hide the source code.</span>
electron-packager <span class="token keyword">.</span> --asar<span class="token operator">=</span>true
</code></pre></div><p>The source code would now be in <code>Contents/Resources/app.asar</code>.</p> <h3 id="icon"><a href="#icon" aria-hidden="true" class="header-anchor">#</a> icon</h3> <p>The icon should be a square picture in several formats. <code>.png</code> for Linux, <code>.ico</code> for Windows, and <code>.icns</code> for Mac. A simple tool for these conversions is http://iconverticons.com. The icons need to be located in the source folder.</p> <div class="language-bash extra-class"><pre class="language-bash"><code>electron-packager <span class="token keyword">.</span> --icon<span class="token operator">=</span>icon
</code></pre></div><h3 id="flags"><a href="#flags" aria-hidden="true" class="header-anchor">#</a> Flags</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Overwrites the previous packaging with the new one.</span>
--overwrite
</code></pre></div><h3 id="full-commands"><a href="#full-commands" aria-hidden="true" class="header-anchor">#</a> Full commands</h3> <p><a href="https://www.christianengvall.se/electron-packager-tutorial" target="_blank" rel="noopener noreferrer">Source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># Linux</span>
electron-packager <span class="token keyword">.</span> electron-tutorial-app --overwrite --asar<span class="token operator">=</span>true --platform<span class="token operator">=</span>linux --arch<span class="token operator">=</span>x64 --icon<span class="token operator">=</span>assets/icons/png/1024x1024.png --prune<span class="token operator">=</span>true --out<span class="token operator">=</span>release-builds

<span class="token comment"># Windows</span>
electron-packager <span class="token keyword">.</span> electron-tutorial-app --overwrite --asar<span class="token operator">=</span>true --platform<span class="token operator">=</span>win32 --arch<span class="token operator">=</span>ia32 --icon<span class="token operator">=</span>assets/icons/win/icon.ico --prune<span class="token operator">=</span>true --out<span class="token operator">=</span>release-builds --version-string.CompanyName<span class="token operator">=</span>CE --version-string.FileDescription<span class="token operator">=</span>CE --version-string.ProductName<span class="token operator">=</span><span class="token string">&quot;Electron Tutorial App&quot;</span>
</code></pre></div><h2 id="electron-builder"><a href="#electron-builder" aria-hidden="true" class="header-anchor">#</a> Electron Builder</h2> <p>Compared to electron-packager, this has many more features and allows us to package, sign and release the app as a part of a highly configurable workflow. The main use is the ability to publish versions automatically.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">npm</span> <span class="token function">install</span> -g electron-builder
</code></pre></div><p>In order to use this module for efficiently, we can add it as a dev-dependency and run the commands as npm scripts in package.json.</p> <h1 id="updating"><a href="#updating" aria-hidden="true" class="header-anchor">#</a> Updating</h1> <h2 id="electron-updater"><a href="#electron-updater" aria-hidden="true" class="header-anchor">#</a> Electron Updater</h2> <p>Use <code>autoUpdater</code> from <code>electron-updater</code> instead of electon. It allows to listen for various update events after checking a URL.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> electron-updater
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> autoUpdater <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;electron-updater&quot;</span><span class="token punctuation">;</span>

autoUpdater<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;update-available&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="native-node-modules"><a href="#native-node-modules" aria-hidden="true" class="header-anchor">#</a> Native Node Modules</h1> <p><strong>This mostly applies to C based libraries such as bcrypt and ffi.</strong></p> <p>Electron is a pre-built library, and it is often built against a different version of the V8 node binary than your system. Installing native npm packages normally would result in an error like this...</p> <div class="language-bash extra-class"><pre class="language-bash"><code>App threw an error during load.
Error: Module version mismatch. Expected 50, got 46.
</code></pre></div><p>In order to use native modules, we need to manually specify the location of the electron headers. To simplify this, we can use a custom script <code>electron-npm</code>, which we can call instead of <code>npm install</code> for native modules.</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># electron-npm script</span>
<span class="token function">export</span> npm_config_target<span class="token operator">=</span>1.7.10 <span class="token comment"># Electron's version. Find with ./node_modules/.bin/electron -v</span>
<span class="token function">export</span> npm_config_arch<span class="token operator">=</span>x64 <span class="token comment"># The architecture.</span>
<span class="token function">export</span> npm_config_disturl<span class="token operator">=</span>https://atom.io/download/atom-shell <span class="token comment"># Download headers.</span>
<span class="token function">export</span> npm_config_runtime<span class="token operator">=</span>electron <span class="token comment"># Tell node-pre-gyp we are building for Electron.</span>
<span class="token function">export</span> npm_config_build_from_source<span class="token operator">=</span>true <span class="token comment"># Tell node-pre-gyp to build module from source code.</span>
<span class="token function">npm</span> <span class="token function">install</span> <span class="token variable">$1</span> <span class="token comment"># Replace with the first argument passed.</span>
</code></pre></div><p>Now, we can install the npm packages with...</p> <div class="language-bash extra-class"><pre class="language-bash"><code>./electron-npm package <span class="token comment"># Instead of &quot;npm install package&quot;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        
        <a href="/notes/topics/config.html" class="prev">
          Config
        </a></span> <span class="next"><a href="/notes/topics/git.html">
          Git
        </a>
        
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/notes/assets/js/app.b2f0b337.js" defer></script><script src="/notes/assets/js/2.1225d179.js" defer></script><script src="/notes/assets/js/29.c8a41031.js" defer></script>
  </body>
</html>
